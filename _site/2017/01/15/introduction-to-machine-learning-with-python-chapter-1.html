<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Introduction to Machine Learning with Python - Chapter 1</title>
  <meta name="description" content="Essential Tools for Python Machine Learning">

  
  
  <link rel="stylesheet" href="http://localhost:4000/assets/style.css">

  <link rel="canonical" href="http://localhost:4000/2017/01/15/introduction-to-machine-learning-with-python-chapter-1.html">
  <link rel="alternate" type="application/rss+xml" title="Elvin Ouyang's Blog" href="http://localhost:4000/feed.xml">

  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>

  
  <!-- font-smoothing is only applied on dark themes -->
  <body class="font-smoothing">

    <header class="px-2 clearfix">
  <!-- <div class="left-lg absolute-lg left-0 top-0 sm-width-full mt-2">
    <a class="no-underline-hover px-1" href="/">
      <span class="inline-block h4 hide-sm ml-2">&#x261c;</span>
    </a>
    <a class="italic no-underline" href="/">
       home
    </a>
  </div> -->
  <div class="right-lg absolute-lg right-0 top-0">
    <ul class="mt-1 mt-lg-2 mr-2 mr-lg-3">
      <li class="inline-block block-lg text-right ml-1 ml-lg-0">
        <a class="italic h4 bold no-underline" href="/">
          <!-- Elvin Ouyang's Blog -->
          Home
        </a>
      </li>
      
        
        <li class="inline-block block-lg text-right ml-1 ml-lg-0">
          <a class="italic no-underline h4" href="/about/">
            About
          </a>
        </li>
        
      
        
      
        
        <li class="inline-block block-lg text-right ml-1 ml-lg-0">
          <a class="italic no-underline h4" href="/projects/">
            Projects
          </a>
        </li>
        
      
        
        <li class="inline-block block-lg text-right ml-1 ml-lg-0">
          <a class="italic no-underline h4" href="/resources/">
            Resources
          </a>
        </li>
        
      
        
        <li class="inline-block block-lg text-right ml-1 ml-lg-0">
          <a class="italic no-underline h4" href="/study-notes/">
            Study Notes
          </a>
        </li>
        
      
        
      
    </ul>
  </div>
</header>


    <div>
      <article class="container mx-auto px-2" itemscope itemtype="http://schema.org/BlogPosting">
  <div class="mt-4 mb-2 clearfix header-text">
    <h1 class="h0 inline-block py-2 mt-4 header-title">Introduction to Machine Learning with Python - Chapter 1</h1>
    <div class="clearfix mb-4 py-1">
      <p class="h4 lh-condensed"><time datetime="2017-01-15T00:00:00-05:00" itemprop="datePublished">Jan 15, 2017</time></p>
      <div class="col-1 sm-width-full border-top-thick">
      </div>
    </div>
  </div>

  <div class="prose py-4" itemprop="articleBody">
      <h1 id="essential-tools-for-python-machine-learning">Essential Tools for Python Machine Learning</h1>

<h2 id="numpy-arrays">NumPy Arrays</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="k">print</span><span class="p">(</span><span class="s">"x:</span><span class="se">\n</span><span class="s">{}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c"># .format() method will display the array within the {}</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>x:
[[1 2 3]
 [4 5 6]]
</code></pre>
</div>

<h2 id="scipy-sparse-matrix">SciPy Sparse Matrix</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">sparse</span>

<span class="c"># Create a 2D NumPy array with a diagonal of ones,</span>
<span class="c"># and zeros everywhere else</span>
<span class="n">eye</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">NumPy array:</span><span class="se">\n</span><span class="s">{}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eye</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>NumPy array:
[[ 1.  0.  0.  0.]
 [ 0.  1.  0.  0.]
 [ 0.  0.  1.  0.]
 [ 0.  0.  0.  1.]]
</code></pre>
</div>

<p>Sparse Matrix in CSR Format:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Convert the NumPy array to a SciPy sparse matrix in CSR format</span>
<span class="c"># Only the nonzero entries are stored</span>
<span class="n">sparse_matrix</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">csr_matrix</span><span class="p">(</span><span class="n">eye</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">SciPy sparse CSR matrix:</span><span class="se">\n</span><span class="s">{}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sparse_matrix</span><span class="p">))</span>
<span class="c"># string[with{a},{b},{c}].format('a','b','c')</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>SciPy sparse CSR matrix:
  (0, 0)	1.0
  (1, 1)	1.0
  (2, 2)	1.0
  (3, 3)	1.0
</code></pre>
</div>

<p>Sparse Matrix in COO Format:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Create the same sparse matrix using the COO format</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">row_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">col_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">eye_coo</span> <span class="o">=</span> <span class="n">sparse</span><span class="o">.</span><span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">row_indices</span><span class="p">,</span> <span class="n">col_indices</span><span class="p">)))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">COO representation:</span><span class="se">\n</span><span class="s">{}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eye_coo</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>COO representation:
  (0, 0)	1.0
  (1, 1)	1.0
  (2, 2)	1.0
  (3, 3)	1.0
</code></pre>
</div>

<h2 id="matplotlib">Matplotlib</h2>

<p>Used to create scientific plotting in Python</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c"># Generate a sequence of numbers from -10 to 10 with 100 steps</span>
<span class="c"># in between</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="c"># Create a second array using sine</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c"># The plot function makes a line chart of one array against another</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s">"x"</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>[&lt;matplotlib.lines.Line2D at 0x7f6934911e48&gt;]
</code></pre>
</div>

<p><img src="/assets/Introduction%20to%20Machine%20Learning%20with%20Python%20-%20Chapter%201_files/Introduction%20to%20Machine%20Learning%20with%20Python%20-%20Chapter%201_12_1.png" alt="png" /></p>

<h2 id="pandas">Pandas</h2>

<p>Useful tool for data wragling and manipulation similar to <strong>R DataFrame</strong> and <strong>SQL</strong>. Also powerful in terms of importing data from a wide range of files.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="c"># create a simple dataset of people</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">'Name'</span><span class="p">:</span> <span class="p">[</span><span class="s">"John"</span><span class="p">,</span> <span class="s">"Anna"</span><span class="p">,</span> <span class="s">"Peter"</span><span class="p">,</span> <span class="s">"Linda"</span><span class="p">],</span>
<span class="s">'Location'</span> <span class="p">:</span> <span class="p">[</span><span class="s">"New York"</span><span class="p">,</span> <span class="s">"Paris"</span><span class="p">,</span> <span class="s">"Berlin"</span><span class="p">,</span> <span class="s">"London"</span><span class="p">],</span>
<span class="s">'Age'</span> <span class="p">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">33</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">data_pandas</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="c"># IPython.display allows "pretty printing" of dataframes</span>
<span class="c"># in the Jupyter notebook</span>
<span class="k">print</span><span class="p">(</span><span class="n">data_pandas</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>   Age  Location   Name
0   24  New York   John
1   13     Paris   Anna
2   53    Berlin  Peter
3   33    London  Linda
</code></pre>
</div>

<h2 id="mglearn">mglearn</h2>

<p>Data package prepared specific for the text book <em>Introductino to Machine Learning with Python</em> by <strong>Andreas C. Müller</strong> &amp; <strong>Sarah Guido</strong></p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">mglearn</span>
</code></pre>
</div>

<h2 id="checking-the-versions-of-packages-installed">Checking the versions of packages installed</h2>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">sys</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Python version: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">version</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="k">print</span><span class="p">(</span><span class="s">"pandas version: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="k">print</span><span class="p">(</span><span class="s">"matplotlib version: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="k">print</span><span class="p">(</span><span class="s">"NumPy version: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">scipy</span> <span class="kn">as</span> <span class="nn">sp</span>
<span class="k">print</span><span class="p">(</span><span class="s">"SciPy version: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">IPython</span>
<span class="k">print</span><span class="p">(</span><span class="s">"IPython version: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">IPython</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
<span class="k">print</span><span class="p">(</span><span class="s">"scikit-learn version: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sklearn</span><span class="o">.</span><span class="n">__version__</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Python version: 3.6.0 |Continuum Analytics, Inc.| (default, Dec 23 2016, 12:22:00)
[GCC 4.4.7 20120313 (Red Hat 4.4.7-1)]
pandas version: 0.19.2
matplotlib version: 1.5.3
NumPy version: 1.11.3
SciPy version: 0.18.1
IPython version: 5.1.0
scikit-learn version: 0.18.1
</code></pre>
</div>

<h1 id="taste-of-machine-learning-with-iris">Taste of Machine Learning with Iris</h1>

<h3 id="step-1"><strong>Step 1:</strong></h3>
<p>Load iris data from scikit-learn package and explore the data.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="n">iris_dataset</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Keys of iris_dataset:</span><span class="se">\n</span><span class="s">{}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iris_dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Keys of iris_dataset:
dict_keys(['data', 'target', 'target_names', 'DESCR', 'feature_names'])
</code></pre>
</div>

<p>The returned iris dataset comes as a <em>bunch</em> object, which is similar to a dictionary. The keys in this dictionary is listed above; we can check out  the feature names and target names.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">iris_dataset description:</span><span class="se">\n</span><span class="s">{}"</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">[</span><span class="s">'feature_names'</span><span class="p">]))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>iris_dataset description:
['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">Target names:</span><span class="se">\n</span><span class="s">{}"</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">[</span><span class="s">'target_names'</span><span class="p">]))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Target names:
['setosa' 'versicolor' 'virginica']
</code></pre>
</div>

<p>Apparently the main three “target categories” are ‘setosa’, ‘versicolor’, and ‘virginica’, and the variables included in the dataset are ‘sepal length’, ‘sepal width’, ‘petal length’, and ‘petal width’. We then need to check out the real data included in the dictionary.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Type of data: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">[</span><span class="s">'data'</span><span class="p">])))</span>
<span class="c"># Check out the type of the value to the 'data' key</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Shape of data: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">[</span><span class="s">'data'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="c"># Check out the .shape method of the numpy array</span>
<span class="k">print</span><span class="p">(</span><span class="s">"First five columns of data:</span><span class="se">\n</span><span class="s">{}"</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">[</span><span class="s">'data'</span><span class="p">][:</span><span class="mi">5</span><span class="p">]))</span>
<span class="c"># Check out the first few rows</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Type of data: &lt;class 'numpy.ndarray'&gt;
Shape of data: (150, 4)
First five columns of data:
[[ 5.1  3.5  1.4  0.2]
 [ 4.9  3.   1.4  0.2]
 [ 4.7  3.2  1.3  0.2]
 [ 4.6  3.1  1.5  0.2]
 [ 5.   3.6  1.4  0.2]]
</code></pre>
</div>

<p>Therefore, in the data (as NumPy array), we will see the numbers corresponding to the four features. What is the first five target values of these five flowers?</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Type of target: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">[</span><span class="s">'target'</span><span class="p">])))</span>
<span class="c"># Check out the data type of the value with 'target' key</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Shape of target: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">[</span><span class="s">'target'</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="c"># Check out the dimension of the value</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Target:</span><span class="se">\n</span><span class="s">{}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iris_dataset</span><span class="p">[</span><span class="s">'target'</span><span class="p">][:</span><span class="mi">5</span><span class="p">]))</span>
<span class="c"># Check out the contents of the array</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Type of target: &lt;class 'numpy.ndarray'&gt;
Shape of target: (150,)
Target:
[0 0 0 0 0]
</code></pre>
</div>

<p>Out of the 150 flowers included in the dataset, the first five of them are all 0, i.e. setosa.</p>

<h3 id="step-2"><strong>Step 2:</strong></h3>
<p>Split the dataset to create <em>training data</em> (or <em>training set</em>) and <em>test data</em> (or <em>test set</em>).</p>

<p>In standardized machine learning task, use <strong>capital X</strong> to represent data and use <strong>lowercase y</strong> to represent labels.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">iris_dataset</span><span class="p">[</span><span class="s">'data'</span><span class="p">],</span> <span class="n">iris_dataset</span><span class="p">[</span><span class="s">'target'</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c"># train_test_split(features, targets, random_state) returns</span>
<span class="c"># X_train, X_test, y_train, y_test</span>
<span class="k">print</span><span class="p">(</span><span class="s">"X_train shape: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"y_train shape: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"X_test shape: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"y_test shape: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>X_train shape: (112, 4)
y_train shape: (112,)
X_test shape: (38, 4)
y_test shape: (38,)
</code></pre>
</div>

<h3 id="step-3"><strong>Step 3:</strong></h3>
<p>Explore the data with basic visualizations</p>

<p><strong>Pair Plot</strong> creates scatterplots for each one of the possible pairs specified in the analysis.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># To visualize the data, we need to transfer the numpy arrays into</span>
<span class="c"># pandas dataframe</span>
<span class="n">iris_dataframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span>
                              <span class="n">columns</span> <span class="o">=</span> <span class="n">iris_dataset</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="c"># Create a scatter matrix from the data frame, color by y_train</span>
<span class="n">grr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">scatter_matrix</span><span class="p">(</span><span class="n">iris_dataframe</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span>
                       <span class="n">marker</span><span class="o">=</span><span class="s">'o'</span><span class="p">,</span> <span class="n">hist_kwds</span><span class="o">=</span><span class="p">{</span><span class="s">'bins'</span><span class="p">:</span><span class="mi">20</span><span class="p">},</span> <span class="n">s</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=.</span><span class="mi">8</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">mglearn</span><span class="o">.</span><span class="n">cm3</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="/assets/Introduction%20to%20Machine%20Learning%20with%20Python%20-%20Chapter%201_files/Introduction%20to%20Machine%20Learning%20with%20Python%20-%20Chapter%201_37_0.png" alt="png" /></p>

<p>A quick glance from the data confirms that the dot categories are well seperated for most of the feature pairs, indicating that a machine learning model is doable.</p>

<h3 id="step-4"><strong>Step 4:</strong></h3>
<p>We will build a <em>k-Nearest Neighbors model</em> on the dataset.</p>

<p>All machine learning models in scikit-learn are implemented in their own classes, which are called <em>Estimator</em> classes. The k-nearest neighbors classification algorithm is implemented in the <em>KNeighborsClassifier</em> class in the <strong>neighbors</strong> module. Before
we can use the model, we need to instantiate the class into an object. This is when we will set any parameters of the model. The most important parameter of KNeighborsClassifier is the <em>number of neighbors</em>, which we will set to 1.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Instantiate a knn class while defining its major parameter: number</span>
<span class="c"># of neighbors</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c"># Call .fit() method on the knn object to run the algorithm on the</span>
<span class="c"># training data</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>KNeighborsClassifier(algorithm='auto', leaf_size=30, metric='minkowski',
           metric_params=None, n_jobs=1, n_neighbors=1, p=2,
           weights='uniform')
</code></pre>
</div>

<p>The resulted knn model will be automatically modified by the algorithm to best reflect on the training set.</p>

<h3 id="step-5"><strong>Step 5:</strong></h3>
<p>Use the knn model to predict the category of a unlabeled flower.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Suppose we have a new unlabeled flower as X_new</span>
<span class="n">X_new</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mf">0.2</span><span class="p">]])</span>
<span class="c"># Be sure to always create two-dimensional array for scikit-learn</span>
<span class="k">print</span><span class="p">(</span><span class="s">"X_new.shape: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">X_new</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>X_new.shape: (1, 4)
</code></pre>
</div>

<p>Call the .predict() method of the knn object with X_new as argument to calculate the estimated Target value.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">prediction</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Prediction: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prediction</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Predicted target name: {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">iris_dataset</span><span class="p">[</span><span class="s">'target_names'</span><span class="p">][</span><span class="n">prediction</span><span class="p">]))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Prediction: [0]
Predicted target name: ['setosa']
</code></pre>
</div>

<p>However, since we don’t have the actual “correct” answer about this X_new flower, we won’t be able to evaluate the model. Using the X_test and y_test, however, will help us evaluate the model.</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Calculate the predicted values for the X_test</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">knn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Test set predictions:</span><span class="se">\n</span><span class="s"> {}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_pred</span><span class="p">))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Test set predictions:
 [2 1 0 2 0 2 0 1 1 1 2 1 1 1 1 0 1 1 0 0 2 1 0 0 2 0 0 1 1 0 2 1 0 2 2 1 0
 2]
</code></pre>
</div>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="c"># Calculate the accuracy of the model</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Test set score: {:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_pred</span><span class="o">==</span><span class="n">y_test</span><span class="p">)))</span>
<span class="c"># Alternatively, use the .score() method for the knn object</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Test set score: {:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Test set score: 0.97
Test set score: 0.97
</code></pre>
</div>

<p>The <em>knn</em> model gives a high accuracy of 0.97 on future cases. For an easier access in future, below is the <strong>snippet</strong> for <strong>knn</strong> models:</p>

<div class="language-python highlighter-rouge"><pre class="highlight"><code><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<span class="n">iris_dataset</span><span class="p">[</span><span class="s">'data'</span><span class="p">],</span> <span class="n">iris_dataset</span><span class="p">[</span><span class="s">'target'</span><span class="p">],</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">knn</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">knn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Test set score: {:.2f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">knn</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)))</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>Test set score: 0.97
</code></pre>
</div>

  </div>
</article>

<div class="container mx-auto px-2 py-2 clearfix">
  <!-- Use if you want to show previous and next for all posts. -->



  <div class="col-4 sm-width-full left mr-lg-4 mt-3">
    <a class="no-underline-hover py-1 block" href="http://localhost:4000/2016/12/05/oop-with-r-s3-and-r6.html">
      <span class="h5 bold">Previous</span>
      <p class="bold h3 link-primary mb-1">Object-Oriented Programming with R</p>
      <p>1. Introduction to OOP in R Difference between functional programming and OOP? Functional Programming: functions first, then object OOP: data...</p>
    </a>
  </div>
  
  
  <div class="col-4 sm-width-full left mt-3">
    <a class="no-underline-hover py-1 block" href="http://localhost:4000/2017/01/18/python-datasets-and-knn.html">
      <span class="h5 bold">Next</span>
      <p class="bold h3 link-primary mb-1">Introduction to Machine Learning with Python - Chapter 2 - Datasets and kNN</p>
      <p>```python import sys print("Python version: {}".format(sys.version)) import pandas as pd print("pandas version: {}".format(pd.__version__)) import matplotlib print("matplotlib version: {}".format(matplotlib.__version__)) import numpy...</p>
    </a>
  </div>


</div>

    </div>

    <div class="container mx-auto clearfix mt-2 mt-lg-4 px-2">
  <div class="border-top-thick">
    <p class="col-8 sm-width-full left py-2 mb-0">This project is maintained by <a class="text-accent" href="https://github.com/ElvinOuyang">ElvinOuyang</a></p>
    <ul class="list-reset right clearfix sm-width-full py-2 mb-2 mb-lg-0">
      <li class="inline-block mr-1">
        <a href="https://twitter.com/share" class="twitter-share-button" data-hashtags="Elvin Ouyang's Blog">Tweet</a> <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      </li>
      <li class="inline-block">
        <a class="github-button" href="https://github.com/ElvinOuyang/elvinouyang.github.io" data-icon="octicon-star" data-count-href="ElvinOuyang//stargazers" data-count-api="/repos/ElvinOuyang/#stargazers_count" data-count-aria-label="# stargazers on GitHub" aria-label="Star ElvinOuyang/ on GitHub">Star</a>
      </li>
    </ul>
  </div>
</div>


  </body>

</html>
